@using Microsoft.AspNetCore.Identity
@using RWSS.ViewModels.Dashboard
@inject SignInManager<AppUser> SignInManager

@model DashboardViewModel

<h1 class="display-4 fw-normal">User Dashboard</h1>
<a type="button" class="btn btn-primary" asp-area="" asp-controller="Dashboard" asp-action="EditUserProfile">Edytuj profil użytkownika</a>
@if (User.Identity.IsAuthenticated && User.IsInRole("rwssadmin"))
{
    <a type="button" asp-controller="Dashboard" asp-action="EditStudentProfile"
       class="btn btn-primary">Edytuj profil studenta</a>
    <a type="button" asp-controller="Event" asp-action="Create"
       class="btn btn-primary">Dodaj wydarzenie</a>
    <a type="button" asp-controller="Account" asp-action="RegisterDeaneryWorker"
       class="btn btn-primary">Dodaj konto specjalne</a>
    <a type="button" asp-controller="Assignment" asp-action="Index"
       class="btn btn-primary">Aktywne zadania</a>
    <a type="button" asp-controller="Duty" asp-action="Index"
       class="btn btn-primary">Aktywne dyżury</a>
       <!--DO POPRAWY: -->
    <a type="button" asp-controller="Dashboard" asp-action="SelectDeaneryWorker" 
       class="btn btn-primary">Skontaktuj się z pracownikiem dziekanatu</a>
    <a type="button" asp-controller="Dashboard" asp-action="SelectRWSSUser"
       class="btn btn-primary">Skontaktuj się z członkiem RWSS</a>
}
else if (User.Identity.IsAuthenticated && User.IsInRole("deaneryworker"))
{
    <a type="button" asp-controller="Dashboard" asp-action="EditDeaneryWorkerProfile"
       class="btn btn-primary">Edytuj profil pracownika dziekanatu</a>
    <a type="button" asp-controller="Event" asp-action="Create"
       class="btn btn-primary">Dodaj wydarzenie</a>
    <a type="button" asp-controller="Dashboard" asp-action="SendEmail"
       class="btn btn-primary">Skontaktuj się z przewodniczącym RWSS</a>
}
else if (User.Identity.IsAuthenticated && User.IsInRole("rwssuser"))
{
    <a type="button" asp-controller="Dashboard" asp-action="EditStudentProfile"
       class="btn btn-primary">Edytuj profil studenta</a>
    <a type="button" asp-controller="Assignment" asp-action="GetMyAssignments"
       class="btn btn-primary">Moje zadania</a>
    <a type="button" asp-controller="Duty" asp-action="GetMyDuties"
       class="btn btn-primary">Moje dyżury</a>
    <a type="button" asp-controller="Dashboard" asp-action="Create"
       class="btn btn-primary">Skontaktuj się z przewodniczącym RWSS</a>
}

<div class="album py-5 bg-light">

            @if (User.Identity.IsAuthenticated && User.IsInRole("rwssadmin"))
            {
                <div class="container">
                <h2 class="display-4 fw-normal">Wszystkie wydarzenia:</h2>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                @foreach (var item in Model.Events)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.Title</p>
                            <p class="card-text">@item.EventDate.ToShortDateString()</p>
                            <p class="card-text">@item.EventCategory</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <a type="btn btn=success" asp-controller="Event" asp-action="Detail" asp-route-id="@item.Id"
                                    class="btn btn-sm btn-outline-secondary">Szczegóły</a>
                                <a type="btn btn=success" asp-controller="Event" asp-action="Edit" asp-route-id="@item.Id"
                                    class="btn btn-sm btn-outline-secondary">Edytuj</a>
                                <a type="btn btn=success" asp-controller="Event" asp-action="Delete" asp-route-id="@item.Id"
                                    class="btn btn-sm btn-outline-secondary">Usuń</a>
                            </div>
                        </div>
                    </div>
                }
                </div>
                </div>
                <h2>Lista studentów:</h2>
                <h10>Indeks:  Imię:    Nazwisko:</h10>
                @foreach (var item in Model.Students)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.IndexNumber @item.AppUser.FirstName @item.AppUser.LastName @item.AppUser.RoleCategory</p>
                                <a type="button" class="btn btn-sm btn-outline-secondary" asp-area="" asp-controller="Dashboard"
                                     asp-action="EditProfileRoles" asp-route-id="@item.AppUser.Id">Edytuj rolę użytkownika</a>
                        </div>
                    </div>
                }
                <h2>Lista pracowników dziekanatu:</h2>
                <h10>Pozycja:  Imię:    Nazwisko:</h10>
                @foreach (var item in Model.DeaneryWorkers)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.PositionCategory @item.AppUser.FirstName @item.AppUser.LastName</p>
                        </div>
                    </div>
                }
                <h2>Lista członków RWSS:</h2>
                <h10>Imię:    Nazwisko:</h10>
                @foreach (var item in Model.RWSSStudents)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.AppUser.FirstName @item.AppUser.LastName</p>
                            <a type="button" class="btn btn-sm btn-outline-secondary" asp-area="" asp-controller="Assignment" asp-route-id="@item.Id"
                               asp-action="Create">Przydziel zadanie</a>
                            <a type="button" class="btn btn-sm btn-outline-secondary" asp-area="" asp-controller="Duty" asp-route-id="@item.Id"
                               asp-action="Create">Przydziel dyżur</a>
                        </div>
                    </div>
                }
            }
            else if (User.Identity.IsAuthenticated && User.IsInRole("deaneryworker"))
            {
                <div class="container">
                    <h2 class="display-4 fw-normal">Wszystkie wydarzenia:</h2>
                    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                        @foreach (var item in Model.Events)
                        {
                            <div class="col-md-4">
                                <div class="card mb-4 box-shadow">
                                    <p class="card-text">@item.Title</p>
                                    <p class="card-text">@item.EventDate.ToShortDateString()</p>
                                    <p class="card-text">@item.EventCategory</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <a type="btn btn=success" asp-controller="Event" asp-action="Detail" asp-route-id="@item.Id"
                                           class="btn btn-sm btn-outline-secondary">Szczegóły</a>
                                        <a type="btn btn=success" asp-controller="Event" asp-action="Edit" asp-route-id="@item.Id"
                                           class="btn btn-sm btn-outline-secondary">Edytuj</a>
                                        <a type="btn btn=success" asp-controller="Event" asp-action="Delete" asp-route-id="@item.Id"
                                           class="btn btn-sm btn-outline-secondary">Usuń</a>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <h2>Lista studentów:</h2>
                <h10>Indeks:  Imię:    Nazwisko:</h10>
                @foreach (var item in Model.Students)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.IndexNumber @item.AppUser.FirstName @item.AppUser.LastName @item.AppUser.RoleCategory</p>
                        </div>
                    </div>
                }
                <h2>Lista pracowników dziekanatu:</h2>
                <h10>Pozycja:  Imię:    Nazwisko:</h10>
                @foreach (var item in Model.DeaneryWorkers)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.PositionCategory @item.AppUser.FirstName @item.AppUser.LastName</p>
                        </div>
                    </div>
                }
            }
            else if (User.Identity.IsAuthenticated && User.IsInRole("rwssuser"))
            {
                <div class="container">
                <h2 class="display-4 fw-normal">Moje wydarzenia</h2>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                @foreach (var item in Model.UserEvents)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.Title</p>
                            <p class="card-text">@item.EventDate.ToShortDateString()</p>
                            <p class="card-text">@item.EventCategory</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <a type="btn btn=success" asp-controller="Event" asp-action="Detail" asp-route-id="@item.Id"
                                   class="btn btn-sm btn-outline-secondary">Szczegóły</a>
                            </div>
                        </div>
                    </div>
                }
                </div>
                </div>
            }
            else if (User.Identity.IsAuthenticated && User.IsInRole("student"))
            {
                <div class="container">
                <h2 class="display-4 fw-normal">Moje wydarzenia</h2>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                @foreach (var item in Model.UserEvents)
                {
                    <div class="col-md-4">
                        <div class="card mb-4 box-shadow">
                            <p class="card-text">@item.Title</p>
                            <p class="card-text">@item.EventDate.ToShortDateString()</p>
                            <p class="card-text">@item.EventCategory</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <a type="btn btn=success" asp-controller="Event" asp-action="Detail" asp-route-id="@item.Id"
                                   class="btn btn-sm btn-outline-secondary">Szczegóły</a>
                            </div>
                        </div>
                    </div>
                }
                </div>
                </div>
            }
            
        </div>